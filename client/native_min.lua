_G["xPlayer"],_G["source"],_G["developer"]={},GetPlayerServerId(PlayerId()),function()end;local a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t=AddTextEntry,BeginTextCommandDisplayHelp,EndTextCommandDisplayHelp,SetNotificationTextEntry,AddTextComponentSubstringPlayerName,DrawNotification,GetEntityCoords,World3dToScreen2d,SetTextScale,SetTextFont,SetTextEntry,SetTextCentre,AddTextComponentString,DrawText,DoesEntityExist,GetDistanceBetweenCoords,GetPlayerPed,TriggerEvent,TriggerServerEvent;local u=GetCurrentResourceName()local v={["ESC"]=322,["F1"]=288,["F2"]=289,["F3"]=170,["F5"]=166,["F6"]=167,["F7"]=168,["F8"]=169,["F9"]=56,["F10"]=57,["~"]=243,["1"]=157,["2"]=158,["3"]=160,["4"]=164,["5"]=165,["6"]=159,["7"]=161,["8"]=162,["9"]=163,["-"]=84,["="]=83,["BACKSPACE"]=177,["TAB"]=37,["Q"]=44,["W"]=32,["E"]=38,["R"]=45,["T"]=245,["Y"]=246,["U"]=303,["P"]=199,["["]=39,["]"]=40,["ENTER"]=18,["CAPS"]=137,["A"]=34,["S"]=8,["D"]=9,["F"]=23,["G"]=47,["H"]=74,["K"]=311,["L"]=182,["LEFTSHIFT"]=21,["Z"]=20,["X"]=73,["C"]=26,["V"]=0,["B"]=29,["N"]=249,["M"]=244,[","]=82,["."]=81,["LEFTCTRL"]=36,["LEFTALT"]=19,["SPACE"]=22,["RIGHTCTRL"]=70,["HOME"]=213,["PAGEUP"]=10,["PAGEDOWN"]=11,["DELETE"]=178,["LEFT"]=174,["RIGHT"]=175,["TOP"]=27,["DOWN"]=173,["NENTER"]=201,["N4"]=108,["N5"]=60,["N6"]=107,["N+"]=96,["N-"]=97,["N7"]=117,["N8"]=61,["N9"]=118}DevModeStatus=false;UtilityLibLoaded=true;local w={Cache={PlayerPedId=PlayerPedId(),Marker={},Object={},Dialogue={},Blips={},N3d={},Events={},Guards={},Scenes={},SetData={},Frozen={},FlowDetector={},Textures={},Settings={},EntityStack={},Loop={},SliceGroups={}}}UtilityNet={}Citizen.CreateThreadNow(function()if UFAPI then if u=="utility_lib"then _G["Utility"]=w else _G["UtilityLibrary"]=w end else _G["Utility"]=w end end)UseDelete=function(x)w.Cache.Settings.UseDelete=x end;On=function(type,y,z)RegisterNetEvent("Utility:On:"..(z and"!"or"")..type)local A=AddEventHandler("Utility:On:"..(z and"!"or"")..type,y)table.insert(w.Cache.Events,A)return A end;_G.old_TaskVehicleDriveToCoord=TaskVehicleDriveToCoord;TaskVehicleDriveToCoord=function(ped,B,C,D,E)old_TaskVehicleDriveToCoord(ped,B,C,D or 10.0,0,GetEntityModel(B),2883621,E or 1.0)end;_G.old_DisableControlAction=DisableControlAction;DisableControlAction=function(F,G,H)H=H~=nil and H or true;if v[string.upper(F)]then if G==nil then G=true end;return old_DisableControlAction(0,v[string.upper(F)],G)else if F>2 then H=G;G=F;F=0 end;return old_DisableControlAction(F,G,H)end end;DisableControlForSeconds=function(G,I)local J=I;Citizen.CreateThread(function()while J>0 do Citizen.Wait(1000)J=J-1 end;return end)Citizen.CreateThread(function()while J>0 do DisableControlAction(v[string.upper(G)])Citizen.Wait(1)end;return end)end;_G.old_IsControlJustPressed=IsControlJustPressed;IsControlJustPressed=function(K,L,M)if type(K)=="number"then local N=K;local G=L;return old_IsControlJustPressed(N,G)end;developer("^2Created^0","key map",K)local O="keyboard"K=K:lower()if K:find("mouse_")then O="mouse_button"elseif K:find("iom_wheel")then O="mouse_wheel"elseif K:find("_index")then O="pad_digitalbutton"elseif K:find("iom_axis")then O="pad_axis"end;RegisterKeyMapping('utility '..u..' '..K,M or'',O,K)local P=nil;Citizen.CreateThread(function()Citizen.Wait(500)P=RegisterNetEvent("Utility:Pressed_"..u.."_"..K,L)table.insert(w.Cache.Events,P)end)end;ShowNotification=function(Q)d('STRING')e(Q)f(false,true)end;ButtonNotification=function(Q,R)if string.match(Q,"{.*}")then Q=string.multigsub(Q,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_RIGHT_ONLY~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})end;if not R then R=true end;a('ButtonNotification'..string.len(Q),Q)b('ButtonNotification'..string.len(Q))c(0,false,R,-1)end;ButtonFor=function(Q,S)local T=GetGameTimer()Citizen.CreateThread(function()while GetGameTimer()-T<(S or 5000)do ButtonNotification(Q)Citizen.Wait(1)end end)end;FloatingNotification=function(Q,U)a('FloatingNotification',Q)SetFloatingHelpTextWorldPosition(1,U)SetFloatingHelpTextStyle(1,1,2,-1,3,0)b('FloatingNotification')c(2,false,false,-1)end;MakeEntityFaceEntity=function(V,W,X)local Y=g(V,true)local Z=g(W,true)if X then local _=GetHeadingFromVector_2d(Z.x-Y.x,Z.y-Y.y)SetEntityHeading(V,_)else local _=GetHeadingFromVector_2d(Y.x-Z.x,Y.y-Z.y)SetEntityHeading(W,_)end end;DrawText3Ds=function(U,a0,a1,a2,a3)if U then local a4,a5,a6=h(U.x,U.y,U.z)if a4 then i(a1 or 0.35,a1 or 0.35)j(a2 or 4)k("STRING")l(1)m(a0)o(a5,a6)if a3 then local a7=string.len(a0)/370;local a8,a9=string.gsub(a7,"\n","\n")*0.025;if a9==nil then a9=0 end;DrawRect(a5,a6+0.0125,0.025+a7,0.025+a9,0,0,0,90)end end end end;_G.old_TaskPlayAnim=TaskPlayAnim;TaskPlayAnim=function(ped,aa,...)if not HasAnimDictLoaded(aa)then RequestAnimDict(aa)while not HasAnimDictLoaded(aa)do Citizen.Wait(1)end end;old_TaskPlayAnim(ped,aa,...)RemoveAnimDict(aa)end;TaskEasyPlayAnim=function(ab,ac,ad,ae)if ad==nil then ad=51 end;if ae==nil then ae=-1 end;TaskPlayAnim(PlayerPedId(),ab,ac,2.0,2.0,ae,ad,0)if ae>-1 or ae>0 then Citizen.Wait(ae)end end;_G.old_CreateObject=CreateObject;CreateObject=function(af,...)local ag=af;if type(af)=="string"then ag=GetHashKey(af)end;if not IsModelValid(ag)then error("Model \""..af.."\" loaded from \""..GetCurrentResourceName().."\" is not valid^0")return end;if not HasModelLoaded(ag)then RequestModel(ag)while not HasModelLoaded(ag)do Citizen.Wait(1)end end;local ah=old_CreateObject(ag,...)if w.Cache.Settings.UseDelete then table.insert(w.Cache.EntityStack,ah)end;SetModelAsNoLongerNeeded(ag)local ai=0;if NetworkGetEntityIsNetworked(ah)then ai=ObjToNet(ah)SetNetworkIdExistsOnAllMachines(ai,true)SetNetworkIdCanMigrate(ai,true)end;return ah,ai end;_G.old_CreatePed=CreatePed;CreatePed=function(ag,...)if type(ag)=="string"then ag=GetHashKey(ag)end;if not HasModelLoaded(ag)then RequestModel(ag)while not HasModelLoaded(ag)do Citizen.Wait(1)end end;local ped=old_CreatePed(0,ag,...)SetModelAsNoLongerNeeded(ag)local ai=0;if NetworkGetEntityIsNetworked(ped)then ai=PedToNet(ped)SetNetworkIdExistsOnAllMachines(ai,true)SetNetworkIdCanMigrate(ai,true)end;return ped,ai end;SetPedStatic=function(aj,ak)FreezeEntityPosition(aj,ak)SetEntityInvincible(aj,ak)SetBlockingOfNonTemporaryEvents(aj,ak)end;_G.old_CreateVehicle=CreateVehicle;CreateVehicle=function(ag,...)if type(ag)=="string"then ag=GetHashKey(ag)end;if not HasModelLoaded(ag)then RequestModel(ag)while not HasModelLoaded(ag)do Citizen.Wait(1)end end;local al=old_CreateVehicle(ag,...)SetModelAsNoLongerNeeded(ag)local ai=0;if NetworkGetEntityIsNetworked(al)then ai=VehToNet(al)SetNetworkIdExistsOnAllMachines(ai,true)SetNetworkIdCanMigrate(ai,true)end;return al,ai end;_G.old_DeleteEntity=DeleteEntity;DeleteEntity=function(aj,am)if not am then local an=0;NetworkRequestControlOfEntity(aj)while not NetworkRequestControlOfEntity(aj)and an<10 do an=an+1;Citizen.Wait(1)end;if not IsEntityAMissionEntity(aj)then SetEntityAsMissionEntity(aj)end;old_DeleteEntity(aj)else NetworkRequestControlOfNetworkId(aj)local ao=NetworkGetEntityFromNetworkId(aj)local an=0;while not NetworkRequestControlOfEntity(ao)and an<10 do an=an+1;Citizen.Wait(1)end;SetEntityAsMissionEntity(ao)old_DeleteEntity(ao)end end;_G.old_GetPlayerName=GetPlayerName;GetPlayerName=function(ap)return old_GetPlayerName(ap or PlayerId())end;_G.old_PlayerPedId=PlayerPedId;PlayerPedId=function()if not p(w.Cache.PlayerPedId)then w.Cache.PlayerPedId=old_PlayerPedId()end;return w.Cache.PlayerPedId end;StopLoop=function(ap)w.Cache.Loop[ap].status=false end;CreateLoop=function(L,aq,ar)local as=RandomId(5)w.Cache.Loop[as]={status=true,func=L,tick=aq}if ar~=false then Citizen.CreateThread(function()while w.Cache.Loop[as]and w.Cache.Loop[as].status do L(as)Citizen.Wait(aq or 1)end end)end;return as end;PauseLoop=function(as,at)Citizen.SetTimeout(at or 0,function()print("Pausing loop "..as)w.Cache.Loop[as].status=false end)end;ResumeLoop=function(as,at)local au=w.Cache.Loop[as]Citizen.SetTimeout(at or 0,function()print("Resuming loop "..as)au.status=true;Citizen.CreateThread(function()while au and au.status do au.func(as)Citizen.Wait(au.tick or 1)end end)end)end;GetWorldClosestPed=function(av)local aw=0;local ax=GetGamePool("CPed")local U=g(PlayerPedId())local ay=av+5.0;for az=1,#ax do local aA=q(U,g(ax[az]),false)if aA<=av and ax[az]~=PlayerPedId()then if ay>aA then ay=aA;aw=ax[az]end end end;return aw,ax end;GetWorldClosestPlayer=function(av)local aw=0;local aB={}local ay=av+5.0;local ax=GetGamePool("CPed")local U=g(PlayerPedId())for az=1,#ax do if IsPedAPlayer(ax[az])then table.insert(aB,NetworkGetPlayerIndexFromPed(ax[az]))local aA=q(U,g(ax[az]),false)if aA<=av and ax[az]~=PlayerPedId()then if ay>aA then ay=aA;aw=NetworkGetPlayerIndexFromPed(ax[az])end end end end;return aw,aB end;GetEntitySurfaceMaterial=function(aj)local U=GetEntityCoords(aj)local aC=StartShapeTestCapsule(U.x,U.y,U.z,U.x,U.y,U.z-2.5,2,1,aj,7)local a8,aD,a8,a8,aE=GetShapeTestResultIncludingMaterial(aC)return aE,aD end;GetLoadoutOfPed=function(ped)local aF=ESX.GetWeaponList()local aG={}for az=1,#aF,1 do local hash=GetHashKey(aF.name)if HasPedGotWeapon(ped,hash,false)then table.insert(aG,{name=aF.name,hash=hash,ammo=GetAmmoInPedWeapon(ped,hash)})end end;return aG end;local aH=FreezeEntityPosition;FreezeEntityPosition=function(aj,ak)w.Cache.Frozen[aj]=ak;aH(aj,ak)end;IsEntityFrozen=function(aj)return w.Cache.Frozen[aj]==true end;GetNearestValue=function(aI,aJ)local aK=100*100000000000;local aL=0;for az=1,#aJ do local aM=math.abs(aJ[az]-aI)if aM<aK then aK=aM;n=aJ[az]aL=az end end;return n,aK,aL end;StartESX=function(aN,aO)Citizen.CreateThreadNow(function()ESX=exports["es_extended"]:getSharedObject()while ESX.GetPlayerData().job==nil do Citizen.Wait(1)end;uPlayer=ESX.GetPlayerData()xPlayer=uPlayer;if aO~=nil then while ESX.GetPlayerData()[aO]==nil do Citizen.Wait(1)end;uPlayer=ESX.GetPlayerData()xPlayer=uPlayer end;if aO~=nil then RegisterNetEvent('esx:set'..string.upper(aO:sub(1,1))..aO:sub(2),function(aP)uPlayer[aO]=aP;xPlayer=uPlayer end)end;RegisterNetEvent('esx:setJob',function(aP)uPlayer.job=aP;xPlayer=uPlayer;if OnJobUpdate then OnJobUpdate()end end)end)end;StartQB=function()QBCore=exports['qb-core']:GetCoreObject()uPlayer=QBCore.Functions.GetPlayerData()Player=uPlayer;RegisterNetEvent('QBCore:Client:OnPlayerLoaded',function()uPlayer=QBCore.Functions.GetPlayerData()Player=uPlayer end)RegisterNetEvent('QBCore:Client:OnJobUpdate',function(aQ)uPlayer.job=aQ;Player=uPlayer;if OnJobUpdate then OnJobUpdate()end end)end;StartFramework=function()if GetResourceState("qb-core")~="missing"then StartQB()return true elseif GetResourceState("es_extended")~="missing"then StartESX()return true end end;GetDataForJob=function(aP)local aR=promise:new()if GetResourceState("es_extended")=="started"then ESX.TriggerServerCallback("Utility:GetJobData",function(aS)aR:resolve(aS)end,aP)elseif GetResourceState("qb-core")=="started"then QBCore.Functions.TriggerCallback("Utility:GetJobData",function(aS)aR:resolve(aS)end,aP)end;aR=Citizen.Await(aR)return#aR,aR end;local aT=0;GetOnHandObject=function()return aT end;TakeObjectOnHand=function(ped,aU,aV,aW,aX,aY,aZ,a_,b0)developer("^2Taking^0","object",aU.." ("..GetEntityModel(aU)..")")if type(aU)=="number"then NetworkRequestControlOfEntity(aU)while not NetworkHasControlOfEntity(aU)do Citizen.Wait(1)end;TaskPlayAnim(ped,"anim@heists@box_carry@","idle",3.0,3.0,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aU,ped,GetPedBoneIndex(ped,60309),aW or 0.2,aX or 0.08,aY or 0.2,aZ or-45.0,a_ or 290.0,b0 or 0.0,true,true,false,true,1,true)aT=aU elseif type(aU)=="string"then local U=g(ped)local b1=CreateObject(aU,U+vector3(0.0,0.0,aV or 0.2),true,false,false)SetEntityAsMissionEntity(b1)TaskPlayAnim(ped,"anim@heists@box_carry@","idle",3.0,-8,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(b1,ped,GetPedBoneIndex(ped,60309),aW or 0.2,aX or 0.08,aY or 0.2,aZ or-45.0,a_ or 290.0,b0 or 0.0,true,true,false,true,1,true)aT=b1;return b1 end end;DropObjectFromHand=function(b2,b3)if b3 then developer("^1Deleting^0","from hand",b2)DeleteEntity(b2)else developer("^3Dont delete^0","from hand",b2)DetachEntity(b2)SetEntityCoords(b2,GetOffsetFromEntityInWorldCoords(b2,0,0.5,0))PlaceObjectOnGroundProperly(b2)FreezeEntityPosition(b2,true)end;ClearPedTasks(PlayerPedId())aT=0 end;IsInRadius=function(Y,Z,av,b4)local aA=#(Y-Z)if b4 then DrawSphere(Z,av,255,0,0,0.5)end;return aA<av end;IsNearCoords=function(U,av,b4)local aA=#(GetEntityCoords(PlayerPedId())-U)if b4 then DrawSphere(U,av,255,0,0,0.5)end;return aA<av end;GenerateRandomCoords=function(U,av,_)local b5=U.x+math.random(-av,av)local b6=U.y+math.random(-av,av)local a8,b7=GetGroundZFor_3dCoord(b5,b6,200.0,0)if _ then return vector3(b5,b6,b7),math.random(0.0,360.0)end;return vector3(b5,b6,b7)end;SetFor=function(ap,b8,b9)if w.Cache["SetData"][ap]==nil then w.Cache["SetData"][ap]={}end;if type(b8)=="table"then for ba,aI in pairs(b8)do if type(aI)=="function"then developer("^2Setting^0","data","("..ap..") ["..ba.." = "..tostring(aI).."] {table}")else developer("^2Setting^0","data","("..ap..") ["..ba.." = "..json.encode(aI).."] {table}")end;w.Cache["SetData"][ap][ba]=aI end else if type(b9)=="function"then developer("^2Setting^0","data","("..ap..") ["..b8 .." = "..tostring(b9).."] {single}")else developer("^2Setting^0","data","("..ap..") ["..b8 .." = "..json.encode(b9).."] {single}")end;w.Cache["SetData"][ap][b8]=b9 end end;GetFrom=function(ap,b8)if b8==nil then b8="not defined"end;developer("^3Getting^0","data","("..ap..") ["..b8 .."]")if w.Cache["SetData"][ap]~=nil then if b8=="not defined"then return w.Cache["SetData"][ap]else return w.Cache["SetData"][ap][b8]end else return nil end end;local bb=100.0;local bc=8100;local bd=bc/bb;function GetSliceColRowFromCoords(U)local be=math.floor(U.x/bb)local bf=math.floor(U.y/bb)return bf,be end;function GetWorldCoordsFromSlice(bg)local bf=math.floor(bg/bd)local be=bg%bd;return vec3(be*bb,bf*bb,0.0)end;function GetSliceIdFromColRow(bf,be)return math.floor(bf*bd+be)end;function GetSliceFromCoords(bh)local bf,be=GetSliceColRowFromCoords(bh)return GetSliceIdFromColRow(bf,be)end;function GetEntitySlice(aj)return GetSliceFromCoords(GetEntityCoords(aj))end;function GetPlayerSlice(bi)local ped=GetPlayerPed(bi)return GetSliceFromCoords(GetEntityCoords(ped))end;function GetSelfSlice()local ped=PlayerPedId()return GetSliceFromCoords(GetEntityCoords(ped))end;function IsOnScreen(U)local a4,a5,a6=World3dToScreen2d(U.x,U.y,U.z)return a4 end;function GetSurroundingSlices(bg)local bj=bg-bd;local bk=bg+bd;local bl=bg-1;local bm=bg+1;local bn=bg-bd-1;local bo=bg-bd+1;local bp=bg+bd-1;local bq=bg+bd+1;return{math.floor(bj),math.floor(bk),math.floor(bm),math.floor(bl),math.floor(bn),math.floor(bo),math.floor(bp),math.floor(bq)}end;function DrawDebugSlice(bg,br,aV)local bs={}local bt=br and GetSurroundingSlices(bg)or{}for ba,aI in pairs({bg,table.unpack(bt)})do local bu=bg+bd+1;table.insert(bs,{GetWorldCoordsFromSlice(aI)+vec3(0.0,0.0,aV or 500.0),GetWorldCoordsFromSlice(bu)+vec3(0.0,0.0,aV or 500.0)})end;local bv={{255,0,0},{0,255,0},{0,0,255},{255,255,0},{0,255,255},{255,0,255},{255,255,255}}for az=1,#bs do local bw=bv[az%#bv+1]DrawBox(bs[az][1],bs[az][2],bw[1],bw[2],bw[3],150)end end;function SliceUsed(bg)return w.Cache.SliceGroups[bg]or false end;function SetSliceUsed(bg,b9)bg=tonumber(bg)if b9 then w.Cache.SliceGroups[bg]=b9 else w.Cache.SliceGroups[bg]=nil end end;RandomId=function(bx)bx=bx or 5;local by=""for az=1,bx do by=by.."9"end;return math.random(0,by)end;CreateMarker=function(ap,U,bz,bA,bB)if DoesExist("m",ap)then Citizen.Wait(100)return else if type(U)~="vector3"then developer("^1Error^0","You can use only vector3 for coords!",ap)return end;ap=string.gsub(ap,"{r}",RandomId())developer("^2Created^0","Marker",ap)local bC={render_distance=bz,interaction_distance=bA,coords=U,slice=bB and bB.slice=="ignore"and"ignore"or GetSliceFromCoords(U)}if type(bB)=="table"then if bB.rgb~=nil then bC.type=1;bC.rgb=bB.rgb elseif bB.text~=nil then bC.type=0;bC.text=bB.text else bC.type=1;bC.rgb={bB[1],bB[2],bB[3]}end;if bB.type~=nil and type(bB.type)=="number"then bC._type=bB.type end;if bB.direction~=nil and type(bB.direction)=="vector3"then bC._direction=bB.direction end;if bB.rotation~=nil and type(bB.rotation)=="vector3"then bC._rot=bB.rotation end;if bB.scale~=nil and type(bB.scale)=="vector3"then bC._scale=bB.scale end;if bB.alpha~=nil and type(bB.alpha)=="number"then bC.alpha=bB.alpha end;if bB.animation~=nil and type(bB.animation)=="boolean"then bC.anim=bB.animation end;if bB.job~=nil then bC.job=bB.job end;if bB.notify~=nil then local bD=string.multigsub(bB.notify,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})bC.notify=bD end elseif type(bB)=="string"then bC.type=0;bC.text=bB end;w.Cache.Marker[ap]=bC;s("Utility:Create","Marker",ap,bC)end end;SetMarker=function(ap,bE,K,b9)if type(b9)~=bE and b9~=nil then developer("^1Error^0",K.." can be only a "..bE,"[Marker]")return end;if DoesExist("marker",ap)then w.Cache.Marker[ap][K]=b9;s("Utility:Edit","Marker",ap,K,b9)else developer("^1Error^0","Unable to edit the marker as it does not exist",ap)end end;SetMarkerType=function(ap,bE)SetMarker(ap,"number","_type",bE)end;SetMarkerDirection=function(ap,bF)SetMarker(ap,"vector3","_direction",bF)end;SetMarkerRotation=function(ap,bG)SetMarker(ap,"vector3","_rot",bG)end;SetMarkerScale=function(ap,a1)SetMarker(ap,"vector3","_scale",a1)end;SetMarkerColor=function(ap,bH)SetMarker(ap,"table","rgb",bH)end;SetMarkerCoords=function(ap,U)SetMarker(ap,"string","slice",tostring(GetSliceFromCoords(U)))SetMarker(ap,"vector3","coords",U)end;SetMarkerRenderDistance=function(ap,bz)SetMarker(ap,"number","render_distance",bz)end;SetMarkerInteractionDistance=function(ap,bA)SetMarker(ap,"number","interaction_distance",bA)end;SetMarkerAlpha=function(ap,bI)SetMarker(ap,"number","alpha",bI)end;SetMarkerAnimation=function(ap,ak)SetMarker(ap,"boolean","anim",ak)end;SetMarkerDrawOnEntity=function(ap,ak)SetMarker(ap,"boolean","draw_entity",ak)end;SetMarkerNotify=function(ap,a0)if type(a0)=="string"then a0=string.multigsub(a0,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_PICKUP~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})end;SetMarker(ap,"string","notify",a0)end;Set3dText=function(ap,a0)SetMarker(ap,"string","text",a0)end;Set3dTextScale=function(ap,a1)SetMarker(ap,"number","_scale",a1)end;Set3dTextDrawRect=function(ap,ak)SetMarker(ap,"boolean","rect",ak)end;Set3dTextFont=function(ap,a2)SetMarker(ap,"number","font",a2)end;DeleteMarker=function(ap)if not DoesExist("m",ap)then Citizen.Wait(100)return else developer("^1Deleted^0","Marker",ap)w.Cache.Marker[ap]=nil;s("Utility:Remove","Marker",ap)ClearAllHelpMessages()end end;CreateiObject=function(ap,af,bh,_,bA,bJ,aP)developer("^2Created^0 Object "..ap.." ("..af..")")local ah;if bJ~=nil then ah=CreateObject(GetHashKey(af),bh.x,bh.y,bh.z,bJ,false,false)or nil else ah=CreateObject(GetHashKey(af),bh.x,bh.y,bh.z,true,false,false)or nil end;SetEntityHeading(ah,_)SetEntityAsMissionEntity(ah,true,true)FreezeEntityPosition(ah,true)SetModelAsNoLongerNeeded(hash)_object={obj=ah,coords=bh,interaction_distance=bA or 3.0,slice=GetSliceFromCoords(bh),job=aP}w.Cache.Object[ap]=_object;s("Utility:Create","Object",ap,_object)return ah,g(ah)end;DeleteiObject=function(ap,b3)developer("^1Deleted^0","Object",ap)if b3 then DeleteEntity(w.Cache.Object[ap].obj)end;w.Cache.Object[ap]=nil;s("Utility:Remove","Object",ap)end;CreateBlip=function(bK,U,bL,bM,a1)developer("^2Created^0","Blip",bK)local bN=AddBlipForCoord(U)SetBlipSprite(bN,bL)SetBlipScale(bN,a1 or 1.0)SetBlipColour(bN,bM)SetBlipAsShortRange(bN,true)BeginTextCommandSetBlipName('STRING')e(bK)EndTextCommandSetBlipName(bN)return bN end;CreateJobBlip=function(bK,U,aP,bL,bM,a1)s("Utility:Create","Blips",math.random(10000,99999),{name=bK,coords=U,job=aP,sprite=bL,colour=bM,scale=a1 or 1.0})end;SetIdOf=function(type,ap,bO)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ap)then w.Cache[type][bO]=w.Cache[type][ap]w.Cache[type][ap]=nil else developer("^1Error^0","Unable to set id of the "..type.." as it does not exist",ap)return end;developer("^3Change^0","Setted id to "..bO.." of the id",ap)s("Utility:Remove",type,ap)s("Utility:Create",type,bO,w.Cache[type][bO])end;GetDistanceFrom=function(type,ap)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;local aA=0.0;if w.Cache[type][ap].coords~=nil then return q(g(PlayerPedId()),w.Cache[type][ap].coords,true)else return false end end;GetCoordOf=function(type,ap)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ap)then return w.Cache[type][ap].coords else developer("^1Error^0","Unable to get the coords of the id",ap)return false end end;DoesExist=function(type,ap)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"elseif type:lower()=="n3d"or type:lower()=="n"then type="N3d"else return nil end;if w.Cache[type][ap]~=nil then return true else return false end end;CreateCamera=function(U,bP,ak,bQ)local bR=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)SetCamCoord(bR,U)if bP~=nil then SetCamRot(bR,bP.x,bP.y,bP.z)end;if bQ~=nil then ShakeCam(bR,bQ.type or"",bQ.amount or 0.0)end;if ak then SetCamActive(bR,true)RenderScriptCams(1,1,1500)end;return bR end;SwitchBetweenCam=function(bS,bR,ae)SetCamActiveWithInterp(bR,bS,ae or 1500,1,1)Citizen.Wait(ae or 1500)DestroyCam(bS)end;DevMode=function(bT,bU,bV)DevModeStatus=bT;if bU==nil then bU=true end;bV=bV or"%s %s %s"if bT then developer=function(bW,type,ap)local a8,a8,a8,bX,bY,bZ=GetLocalTime()if bU then if type==nil then print(bX..":"..bY..":"..bZ.." - "..bW)else print(bX..":"..bY..":"..bZ.." - "..string.format(bV,bW,type,ap or""))end else if type==nil then print(bW)else print(string.format(bV,bW,type,ap or""))end end end else developer=function()end end end;ReplaceTexture=function(b1,b_,c0,c1,c2)local c3=b1 ..":"..b_..":"local c4=c3 ..":"..c0;if not w.Cache.Textures[c4]then local c5=CreateRuntimeTxd(c3 ..'duiTxd')local c6=CreateDui(c0,c1,c2)local c7=GetDuiHandle(c6)CreateRuntimeTextureFromDuiHandle(c5,c3 ..'duiTex',c7)w.Cache.Textures[c4]=true end;AddReplaceTexture(b1,b_,c3 .."duiTxd",c3 .."duiTex")end;printd=function(c8,c9)if c9 then local ca={}local function cb(cc,cd)if ca[tostring(cc)]then print(cd.."*"..tostring(cc))else ca[tostring(cc)]=true;if type(cc)=="table"then for bh,ce in pairs(cc)do if type(ce)=="table"then print(cd.."["..bh.."] => "..tostring(cc).." {")cb(ce,cd..string.rep(" ",string.len(bh)+8))print(cd..string.rep(" ",string.len(bh)+6).."}")elseif type(ce)=="string"then print(cd.."["..bh.."] => \""..ce.."\"")else print(cd.."["..bh.."] => "..tostring(ce))end end else print(cd..tostring(cc))end end end;if type(c8)=="table"then print(tostring(c8).." {")cb(c8,"  ")print("}")else developer("^1Error^0","error dumping table "..c8 .." why isnt a table")end else if type(c8)=="table"then print(json.encode(c8,{indent=true}))else developer("^1Error^0","error dumping table "..c8 .." why isnt a table")end end end;local cf=string.gsub;string.multigsub=function(string,table,cg)if type(table)then for az=1,#table do string=cf(string,table[az],cg[az])end else for az=1,#table do string=cf(string,table[az],cg)end end;return string end;table.fexist=function(c8,ch)return c8[ch]~=nil end;local ci=table.remove;table.remove=function(c8,cj,ck)if type(cj)=="number"then return ci(c8,cj)elseif type(cj)=="string"then for ba,aI in pairs(c8)do if ba==cj then c8[ba]=nil;if ck then return ba end end end else return ci(c8)end end;table.empty=function(cc)return next(cc)==nil end;local cl=function(cc,ba,aI)if type(ba)=="number"then table.insert(cc,aI)else cc[ba]=aI end end;table.merge=function(cm,cn)local co=table.clone(cm)for ba,aI in pairs(cn)do cl(co,ba,aI)end;return co end;table.includes=function(cc,b9)if type(b9)=="function"then for a8,aI in pairs(cc)do if b9(aI)then return true end end else for a8,aI in pairs(cc)do if b9==aI then return true end end end;return false end;table.filter=function(cc,cp)local co={}if type(cp)=="function"then for ba,aI in pairs(cc)do if cp(ba,aI)then cl(co,ba,aI)end end elseif type(cp)=="table"then for ba,aI in pairs(cc)do if table.includes(cp,aI)then cl(co,ba,aI)end end end;return co end;table.find=function(cc,b9)if type(b9)=="function"then for ba,aI in pairs(cc)do if b9(aI)then return aI,ba end end else for ba,aI in pairs(cc)do if b9==aI then return aI,ba end end end end;table.keys=function(cc)local cq={}for ba,a8 in pairs(cc)do table.insert(cq,ba)end;return cq end;table.values=function(cc)local cr={}for a8,aI in pairs(cc)do table.insert(cr,aI)end;return cr end;table.deepcopy=function(cs,ct)if type(cs)~="table"then return cs end;ct=ct or{}if ct[cs]then return ct[cs]end;local cu=table.clone(cs)ct[cs]=cu;for ba,aI in next,cs do if type(aI)=="table"then cu[ba]=table.deepcopy(aI,ct)end end;return cu end;math.round=function(cv,cw)local a8=10^cw;return math.floor(cv*a8+0.5)/a8 end;local function cx(aj,cy,cz)return{Question=function(...)cy.questions={...}return cx(aj,cy,cz)end,Response=function(...)local cA={...}local cB={}local cC={}for cD,cE in pairs(cA)do cC[cD]={}for ba,aI in pairs(cE)do if cB[cD]==nil then cB[cD]=""end;cB[cD]=cB[cD]..ba.."~w~ "..aI.." | "ba=string.multigsub(ba,{"%[","%]"},{"",""})ba=string.multigsub(ba,{"~r~","~b~","~g~","~y~","~p~","~o~","~c~","~m~","~u~","~n~","~s~","~w~"},{"","","","","","","","","","","",""})cC[cD][ba]=aI end;cB[cD]=cB[cD]:sub(1,-3)end;cy.response={no_formatted=cC,formatted=cB}if cz then s("Utility:Remove","Dialogue",aj)s("Utility:Create","Dialogue",aj,cy)else s("Utility:Create","Dialogue",aj,cy)end;w.Cache.Dialogue[aj]=cy;return cx(aj,cy,cz)end,LastQuestion=function(cF)w.Cache.Dialogue[aj].lastQuestion=cF;s("Utility:Edit","Dialogue",aj,"lastQuestion",cF)return cx(aj,cy,cz)end}end;StartDialogue=function(aj,aA,cG,cH)local cy={entity=aj,distance=aA,curQuestion=1,callback=cG,stopWhenTalking=cH,slice=GetEntitySlice(aj)}developer("^2Created^0","dialogue with entity",aj)return cx(aj,cy)end;EditDialogue=function(aj)if aj~=nil and IsEntityOnDialogue(aj)then return cx(aj,w.Cache.Dialogue[aj],true)end end;StopDialogue=function(aj,cI)if aj~=nil and IsEntityOnDialogue(aj)then developer("^1Stopping^0","dialogue",aj)if cI then w.Cache.Dialogue[aj]=nil else local cJ=w.Cache.Dialogue[aj].questions[1]s("Utility:Edit","Dialogue",aj,"curQuestion",#cJ)end end end;IsEntityOnDialogue=function(aj)return w.Cache.Dialogue[aj]end;RegisterNetEvent("Utility:DeleteDialogue",function(aj)w.Cache.Dialogue[aj]=nil end)function GetScaleformsStatus()local cK={}local cL={}for az=1,10 do local cM="utility_lib_"..az;if IsScaleformTaken(cM)then table.insert(cK,{name=cM,data=w.Cache.N3d[cM]})else table.insert(cL,{name=cM,data={txd=false,show=false,rotation={}}})end end;return cK,cL end;function IsScaleformTaken(cM)return w.Cache.N3d[cM]~=nil end;local cN=RequestScaleformMovie;local function RequestScaleformMovie(cO)local cP,cQ=pcall(cN,cO)while not cP do cP,cQ=pcall(cN,cO)Citizen.Wait(1)end;return cQ end;local function cR(cS,cM)local cT=RequestScaleformMovie(cM)local cU=GetGameTimer()while not HasScaleformMovieLoaded(cT)and GetGameTimer()-cU<4000 do Citizen.Wait(0)end;if GetGameTimer()-cU>4000 then developer("^1Error^0","After 4000 ms to load the scaleform the scaleform has not loaded yet, try again or check that it has started correctly!")return end;w.Cache.N3d[cS].scaleform=cT;s("Utility:Edit","N3d",cS,"scaleform",cT)end;local function cV(cS,c0,c1,c2)local c5=CreateRuntimeTxd('txd'..cS)w.Cache.N3d[cS].dui=CreateDui(c0,c1,c2)s("Utility:Edit","N3d",cS,"dui",w.Cache.N3d[cS].dui)while not IsDuiAvailable(w.Cache.N3d[cS].dui)do Citizen.Wait(1)end;local c7=GetDuiHandle(w.Cache.N3d[cS].dui)CreateRuntimeTextureFromDuiHandle(c5,'txn'..cS,c7)if w.Cache.N3d[cS].scaleform~=nil and not w.Cache.N3d[cS].txd then BeginScaleformMovieMethod(w.Cache.N3d[cS].scaleform,'SET_TEXTURE')ScaleformMovieMethodAddParamTextureNameString('txd'..cS)ScaleformMovieMethodAddParamTextureNameString('txn'..cS)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(c1)ScaleformMovieMethodAddParamInt(c2)EndScaleformMovieMethod()w.Cache.N3d[cS].txd=true;s("Utility:Edit","N3d",cS,"txd",true)end end;function CreateNui3d(cM,c0)local cS=tostring(math.random(0,9999))local cW={txd=false,show=false,rotation={}}w.Cache.N3d[cS]=cW;s("Utility:Create","N3d",cS,cW)cR(cS,cM)if c0~=nil then developer("^2Starting^0",cS.." with url ".."nui://"..GetCurrentResourceName().."/"..c0 .." sf "..cM)cV(cS,"nui://"..GetCurrentResourceName().."/"..c0,1920,1080)end;local cX={}cX.__index=cX;cX.init=function(self,c0,c1,c2)cV(cS,"nui://"..GetCurrentResourceName().."/"..c0,c1 or 1920,c2 or 1080)end;cX.datas=function(self)return w.Cache.N3d[cS]end;cX.scale=function(self,a1)w.Cache.N3d[cS].advanced_scale=a1;s("Utility:Edit","N3d",cS,"advanced_scale",a1)end;cX.rotation=function(self,bP,cY)w.Cache.N3d[cS].rotation.rotation=bP;w.Cache.N3d[cS].rotation.syncedwithplayer=cY;s("Utility:Edit","N3d",cS,"rotation",{rotation=bP,syncedwithplayer=cY})end;cX.destroy=function(self)if w.Cache.N3d[cS].dui~=nil then DestroyDui(w.Cache.N3d[cS].dui)SetScaleformMovieAsNoLongerNeeded(w.Cache.N3d[cS].scaleform)w.Cache.N3d[cS]=nil;s("Utility:Remove","N3d",cS)end end;cX.started=function()return w.Cache.N3d[cS].dui~=nil end;cX.show=function(self,U,a1)w.Cache.N3d[cS].coords=U;w.Cache.N3d[cS].scale=a1 or 0.1;w.Cache.N3d[cS].show=true;s("Utility:Edit","N3d",cS,"coords",U)s("Utility:Edit","N3d",cS,"scale",a1 or 0.1)s("Utility:Edit","N3d",cS,"show",true)end;cX.visible=function()return w.Cache.N3d[cS].show end;cX.hide=function()w.Cache.N3d[cS].show=false;s("Utility:Edit","N3d",cS,"show",false)end;cX.attach=function(self,aj,cZ)w.Cache.N3d[cS].attach={entity=aj,offset=cZ or vector3(0.0,0.0,0.0)}s("Utility:Edit","N3d",cS,"attach",{entity=aj,offset=cZ or vector3(0.0,0.0,0.0)})end;cX.detach=function(self,c_)if c_ then w.Cache.N3d[cS].coords=GetEntityCoords(w.Cache.N3d[cS].attach.entity)s("Utility:Edit","N3d",cS,"coords",w.Cache.N3d[cS].coords)end;w.Cache.N3d[cS].attach=nil;s("Utility:Edit","N3d",cS,"attach",nil)end;cX.object=function()return w.Cache.N3d[cS].dui end;cX.msg=function(self,Q)if self:started()then SendDuiMessage(self:object(),json.encode(Q))end end;cX.replaceTexture=function(self,ab,b_,d0)if d0 then Citizen.Wait(d0)end;AddReplaceTexture(ab,b_,'txd'..cS,'txn'..cS)end;return setmetatable({},cX),cS end;AddEventHandler("onResourceStop",function(d1)if d1==u then for az=1,#w.Cache.Events do RemoveEventHandler(w.Cache.Events[az])end;for d2,d3 in pairs(w.Cache.N3d)do if d3.dui~=nil and IsDuiAvailable(d3.dui)then DestroyDui(d3.dui)end;s("Utility:Remove","N3d",d2)end;if w.Cache.Settings.UseDelete then for az=1,#w.Cache.EntityStack do local d4=w.Cache.EntityStack[az]NetworkRequestControlOfEntity(d4)if DoesEntityExist(d4)then DeleteEntity(d4)end end end end end)local d5=10;local d6=0.01;local d7=0.0000001;local d8=10;local d9=11;local da=1.0/(d9-1.0)local function db(dc,dd)return 1.0-3.0*dd+3.0*dc end;local function de(dc,dd)return 3.0*dd-6.0*dc end;local function df(dc)return 3.0*dc end;local function dg(dh,dc,dd)return((db(dc,dd)*dh+de(dc,dd))*dh+df(dc))*dh end;local function di(dh,dc,dd)return 3.0*db(dc,dd)*dh*dh+2.0*de(dc,dd)*dh+df(dc)end;local function dj(dk,dl,dm,dn,dp)local dq,dr,az=0,0,0;repeat dr=dl+(dm-dl)/2.0;dq=dg(dr,dn,dp)-dk;if dq>0.0 then dm=dr else dl=dr end;az=az+1 until math.abs(dq)<=d7 or az>=d8;return dr end;local function ds(dk,dt,dn,dp)for az=1,d5 do local du=di(dt,dn,dp)if du==0.0 then return dt end;local dq=dg(dt,dn,dp)-dk;dt=dt-dq/du end;return dt end;local function dv(b5)return b5 end;local function dw(dn,dx,dp,dy)if not(0<=dn and dn<=1 and 0<=dp and dp<=1)then error('bezier x values must be in [0, 1] range')end;if dn==dx and dp==dy then return dv end;local dz={}for az=1,d9 do dz[az]=dg((az-1)*da,dn,dp)end;local function dA(dk)local dB=0.0;local dC=1;local dD=d9-1;while dC~=dD and dz[dC]<=dk do dB=dB+da;dC=dC+1 end;dC=dC-1;local dE=(dk-dz[dC])/(dz[dC+1]-dz[dC])local dF=dB+dE*da;local dG=di(dF,dn,dp)if dG>=d6 then return ds(dk,dF,dn,dp)elseif dG==0.0 then return dF else return dj(dk,dB,dB+da,dn,dp)end end;return function(b5)if b5==0 or b5==1 then return b5 end;return dg(dA(b5),dx,dy)end end;local dH={ease={0.25,0.1,0.25,1},easeIn={0.42,0,1,1},easeOut={0,0,0.58,1},easeInOut={0.42,0,0.58,1}}TranslateObjectCoordsCubicBezier=function(ah,C,ae,dI)local dJ=GetEntityCoords(ah)local cU=GetNetworkTimeAccurate()local T=GetNetworkTimeAccurate()local dK=false;local dL=C-dJ;local dM={"x","y","z"}if type(dI)=="string"then dI=dH[dI]if not dI then error("TranslateObjectCoordsCubicBezier: `"..dI.."` its not a predefined cubic bezier")return end end;local dN=dw(table.unpack(dI))while not dK and T-cU<ae do Citizen.Wait(0)local dO=GetNetworkTimeAccurate()if T~=0 and dO-T~=0 then local D={}local dP=(dO-cU)/ae;for ba,aI in pairs(dM)do if dJ[aI]==C[aI]then D[aI]=0 else local dQ=GetEntityCoords(ah)local dR=math.lerp(dJ[aI],C[aI],dN(dP))local aA=math.abs(dQ[aI]-dR)D[aI]=aA end end;dK=SlideObject(ah,C,D.x,D.y,D.z,false)end;T=dO end;SetEntityCoords(ah,C)end;TranslateObjectCoords=function(ah,C,ae)TranslateObjectCoordsCubicBezier(ah,C,ae,{0.1,0.1,0.1,0.1})end;TranslateUniformRectilinearMotion=TranslateObjectCoords;TranslateObjectRotationCubicBezier=function(ah,C,ae,dS,dI)local dT=GetEntityRotation(ah)local cU=GetNetworkTimeAccurate()local T=GetNetworkTimeAccurate()local dM={"x","y","z"}local dU={}for a8,aI in ipairs(dM)do local dV=dT[aI]local dW=C[aI]local dX=(dW-dV+180)%360-180;dU[aI]=dX end;if type(dI)=="string"then dI=dH[dI]if not dI then error("TranslateObjectCoordsCubicBezier: `"..dI.."` its not a predefined cubic bezier")return end end;local dN=dw(table.unpack(dI))while T-cU<ae do Citizen.Wait(0)local dO=GetNetworkTimeAccurate()local dP=(dO-cU)/ae;if T~=0 and dO-T~=0 then local bG={}for ba,aI in ipairs(dM)do local dV=dT[aI]local dX=dU[aI]bG[aI]=dV+dX*dN(dP)end;SetEntityRotation(ah,bG.x,bG.y,bG.z,dS or 2)end;T=dO end;SetEntityRotation(ah,C.x,C.y,C.z,dS or 2)end;TranslateObjectRotation=function(ah,C,ae,dS)TranslateObjectRotationCubicBezier(ah,C,ae,dS,{0.1,0.1,0.1,0.1})end;CreateScene=function(U,bG,dY,dZ,d_,e0)local e1=NetworkCreateSynchronisedScene(U,bG,2,dY or false,dZ or false,1065353216,e0 or 0,d_ or 1.3)w.Cache.Scenes[e1]={coords=U,rotation=bG,players={},entities={},dicts={}}return e1 end;AddEntityToScene=function(aj,e1,ab,bK,D,e2,e3)if not DoesEntityExist(tonumber(aj))then local af=aj;local U=GetEntityCoords(PlayerPedId())aj=CreateObject(aj,U+vector3(0,0,-4.0),true)SetEntityCollision(aj,false,true)w.Cache.Scenes[e1].entities[af]=aj end;RequestAnimDict(ab)while not HasAnimDictLoaded(ab)do Citizen.Wait(1)end;developer("^3Scenes^0","Adding object",aj,"to scene",e1,"[",ab,bK,"]")NetworkAddEntityToSynchronisedScene(aj,e1,ab,bK,D or 4.0,e2 or-8.0,e3 or 1)table.insert(w.Cache.Scenes[e1].dicts,ab)end;AddPlayerToScene=function(bi,e1,ab,bK,...)Citizen.InvokeNative(0x144da052257ae7d8,true)local ped=DoesEntityExist(bi)and bi or GetPlayerPed(bi)AddPedToScene(ped,e1,ab,bK,...)w.Cache.Scenes[e1].players[ped]={dict=ab,name=bK}end;AddPedToScene=function(ped,e1,ab,bK,e4,e5,ae,e3)if not DoesEntityExist(ped)then local af=ped;ped=CreatePed(ped,vector3(0,0,0),0.0,true)w.Cache.Scenes[e1].entities[af]=ped end;RequestAnimDict(ab)while not HasAnimDictLoaded(ab)do Citizen.Wait(1)end;developer("^3Scenes^0","Adding ped",ped,"to scene",e1,"[",ab,bK,"]")NetworkAddPedToSynchronisedScene(ped,e1,ab,bK,e4 or 1.5,e5 or-4.0,ae or 1,e3 or 16,0,0)table.insert(w.Cache.Scenes[e1].dicts,ab)end;GoNearInitialOffset=function(bi,U,bG,ab,bK)local ped=DoesEntityExist(bi)and bi or GetPlayerPed(bi)local _=bG and bG.z or GetEntityHeading(ped)RequestAnimDict(ab)while not HasAnimDictLoaded(ab)do Citizen.Wait(1)end;local bh=GetAnimInitialOffsetPosition(ab,bK,U,0.0,0.0,_,0.0,2)local bG=GetAnimInitialOffsetRotation(ab,bK,U,0.0,0.0,_,0.0,2)RemoveAnimDict(ab)TaskGoStraightToCoord(ped,bh,0.6,-1,bG.z,0.4)local e6=GetGameTimer()while#(GetEntityCoords(ped)-bh)>0.3 and GetGameTimer()-e6<4000 do Citizen.Wait(1)end;while GetEntitySpeed(ped)>0.2 and GetGameTimer()-e6<4000 do Citizen.Wait(50)end;if GetGameTimer()-e6>=4000 then TaskPedSlideToCoord(ped,bh,_,2000)Citizen.Wait(2000)end end;StartScene=function(e1,e7)local e8=w.Cache.Scenes[e1]if e7 then for ped,aI in pairs(e8.players)do GoNearInitialOffset(ped,e8.coords,e8.rotation,aI.dict,aI.name)end end;NetworkStartSynchronisedScene(e1)end;StopScene=function(e1)developer("^3Scenes^0","Stop scene",e1)NetworkStopSynchronisedScene(e1)local e8=w.Cache.Scenes[e1]for af,aj in pairs(e8.entities)do developer("^3Scenes^0","Deleting entity",aj)DeleteEntity(aj)end;for az=1,#e8.dicts do RemoveAnimDict(e8.dicts[az])end end;GetSceneEntity=function(e1,af)if af then return w.Cache.Scenes[e1].entities[af]else return w.Cache.Scenes[e1].entities end end;local e9=function(ea,U)local ped=PlayerPedId()local bG=GetEntityRotation(ea)local e1=CreateScene(U,bG)AddPlayerToScene(ped,e1,"anim@heists@ornate_bank@thermal_charge","thermal_charge")AddEntityToScene("hei_p_m_bag_var22_arm_s",e1,"anim@heists@ornate_bank@thermal_charge","bag_thermal_charge")StartScene(e1,true)return e1 end;local eb=function(ea)local ec=GetEntitySize(ea)if doorHash==GetHashKey("hei_v_ilev_bk_safegate_pris")then return GetOffsetFromEntityInWorldCoords(ea,-(ec.x-0.1),-0.05,0.0)else return GetOffsetFromEntityInWorldCoords(ea,ec.x-0.1,-0.05,0.0)end end;local ed=function(ped,U)local ee=CreateObject("hei_prop_heist_thermite",U-vector3(0,0,5),true)SetEntityCollision(ee,false,false)AttachEntityToEntity(ee,ped,GetPedBoneIndex(ped,28422),0,0,0,0,0,200.0,true,true,false,true,1,true)return ee end;local ef=function(ee)DetachEntity(ee,true,true)end;local eg=function(ee)return StartParticleFxOnNetworkEntity("scr_ornate_heist","scr_heist_ornate_thermal_burn",ee,vector3(0.0,1.0,-0.1),vector3(0.0,0.0,0.0),1.0)end;local eh=function(ped)TaskPlayAnim(ped,"anim@heists@ornate_bank@thermal_charge","cover_eyes_loop",1.5,1.0,-1,51,1,0,0,0)end;local ei=function(ea)local af=GetEntityModel(ea)if af==GetHashKey("hei_v_ilev_bk_gate_pris")then return"hei_v_ilev_bk_gate_molten"elseif af==GetHashKey("hei_v_ilev_bk_gate2_pris")then return"hei_v_ilev_bk_gate2_molten"elseif af==GetHashKey("hei_v_ilev_bk_safegate_pris")then return"hei_v_ilev_bk_safegate_molten"end end;local ej=function(ea)local ek=ei(ea)if ek then SetEntityModel(ea,ek)end end;local el=function(ped,ee)DeleteObject(ee)TaskPlayAnim(ped,"anim@heists@ornate_bank@thermal_charge","cover_eyes_exit",1.0,8.0,1000,51,1,0,0,0)Citizen.Wait(1000)ClearPedTasks(ped)end;BreakDoorWithThermalCharge=function(ea,em,ae)local ped=PlayerPedId()local en=eb(ea)local e1=e9(ea,en)SetPedComponentVariation(ped,5,0,0,0)Citizen.Wait(1000)local ee=ed(ped,en)Citizen.Wait(3000)ef(ee)Citizen.Wait(1000)local eo=eg(ee)StopScene(e1)SetPedComponentVariation(ped,5,em or 45,0,0)developer("^3Scenes^0","Cover eyes")eh(ped)Citizen.Wait(1000)ej(ea)developer("^3Scenes^0","Wait "..(ae or 3000))Citizen.Wait(ae or 3000)el(ped,ee)end;local ep=function(type)if type=="cash"then return"hei_prop_hei_cash_trolly_01"elseif type=="gold"then return"ch_prop_gold_trolly_01a"elseif type=="diamond"then return"ch_prop_diamond_trolly_01a"end end;local eq=function(type)return"utility_heist:"..type.."_trolly:"..math.random(1,10000)end;CreateTrolly=function(type,U,er,bD,es,et,eu,ev)if type(es)=="number"then ev=eu;eu=et;et=es end;local ah=nil;local ap=eq(type)if type=="cash"then ah=CreateObject("hei_prop_hei_cash_trolly_01",U,ev)elseif type=="gold"then ah=CreateObject("ch_prop_gold_trolly_01a",U,ev)elseif type=="diamond"then ah=CreateObject("ch_prop_diamond_trolly_01a",U,ev)end;PlaceObjectOnGroundProperly(ah)CreateMarker(ap,U,0.0,2.0,{notify=bD or"Press {E} to begin looting the trolly"})SetFor(ap,"minSpeed",et)SetFor(ap,"maxSpeed",eu)SetFor(ap,"giveCash",er)SetFor(ap,"repeatedlyPress",es)local P=nil;P=On("marker",function(ew)if ew==ap then local type=ap:match("utility_heist:(%w+)_trolly")local U=GetEntityCoords(PlayerPedId())local af=ep(type)local ex=GetClosestObjectOfType(U,3.0,GetHashKey(af))DeleteMarker(ap)Citizen.Wait(500)ClearAllHelpMessages()if ex>0 then LootTrolly(ap,type,ex)RemoveEventHandler(P)end end end)return ap,ah end;local ey=function(type)if type=="cash"then return"hei_prop_hei_cash_trolly_03"else return"hei_prop_hei_cash_trolly_03"end end;local ez=function(type)if type=="cash"then return"hei_prop_heist_cash_pile"elseif type=="gold"then return"ch_prop_gold_bar_01a"elseif type=="diamond"then return"ch_prop_vault_dimaondbox_01a"end end;local eA=function(ap,er)PlaySoundFrontend(-1,"LOCAL_PLYR_CASH_COUNTER_INCREASE","DLC_HEISTS_GENERAL_FRONTEND_SOUNDS",true)er()end;local eB=function(ap,af,er)local ped=PlayerPedId()local U=GetEntityCoords(ped)local eC=CreateObject(af,U,true)FreezeEntityPosition(eC,true)SetEntityInvincible(eC,true)SetEntityNoCollisionEntity(eC,ped)SetEntityVisible(eC,false,false)AttachEntityToEntity(eC,ped,GetPedBoneIndex(ped,60309),0.0,0.0,0.0,0.0,0.0,0.0,false,false,false,false,0,true)DisableCamCollisionForEntity(eC)w.Cache.LootingTrolly=true;Citizen.CreateThread(function()local eD=GetHashKey("CASH_APPEAR")local eE=GetHashKey("RELEASE_CASH_DESTROY")while w.Cache.LootingTrolly do if HasAnimEventFired(ped,eD)then SetEntityVisible(eC,true,false)end;if HasAnimEventFired(ped,eE)then if IsEntityVisible(eC)then SetEntityVisible(eC,false,false)eA(ap,er)end end;Citizen.Wait(1)end;DeleteObject(eC)end)end;local eF=function(eG,eH)local ped=PlayerPedId()local U=GetEntityCoords(eH)local bG=GetEntityRotation(eH)local e1=CreateScene(U,bG)AddPlayerToScene(ped,e1,"anim@heists@ornate_bank@grab_cash","intro")AddEntityToScene(eG,e1,"anim@heists@ornate_bank@grab_cash","bag_intro")StartScene(e1,true)return e1 end;local eI=function(eJ,eK,eL,es)local eM=NetworkGetLocalSceneFromNetworkId(eJ)local D=eK;local eN=false;Citizen.CreateThread(function()while not eN do if IsControlJustPressed(0,24)then if D<=eL then D=D+0.1 end end;Citizen.Wait(0)end end)while not IsSynchronizedSceneRunning(eM)do eM=NetworkGetLocalSceneFromNetworkId(eJ)Citizen.Wait(1)end;Citizen.CreateThread(function()AddTextEntry('PersistentButtonNotification',es or"Repeatedly press ~INPUT_SCRIPT_RDOWN~ to grab faster")BeginTextCommandDisplayHelp('PersistentButtonNotification')EndTextCommandDisplayHelp(0,true,true,-1)end)while GetSynchronizedScenePhase(eM)<0.99 do eM=NetworkGetLocalSceneFromNetworkId(eJ)if D>eK then D=D-0.1 end;SetSynchronizedSceneRate(eM,D)Citizen.Wait(300)end;ClearAllHelpMessages()eN=true end;local eO=function(eG,eH)local ped=PlayerPedId()local U=GetEntityCoords(eH)local bG=GetEntityRotation(eH)local e1=CreateScene(U,bG)AddPlayerToScene(ped,e1,"anim@heists@ornate_bank@grab_cash","grab")AddEntityToScene(eG,e1,"anim@heists@ornate_bank@grab_cash","bag_grab")AddEntityToScene(eH,e1,"anim@heists@ornate_bank@grab_cash","cart_cash_dissapear")StartScene(e1)return e1 end;local eP=function(eG,eH)local ped=PlayerPedId()local U=GetEntityCoords(eH)local bG=GetEntityRotation(eH)local e1=CreateScene(U,bG)AddPlayerToScene(ped,e1,"anim@heists@ornate_bank@grab_cash","exit")AddEntityToScene(eG,e1,"anim@heists@ornate_bank@grab_cash","bag_exit")StartScene(e1)return e1 end;LootTrolly=function(ap,type,eH)local ped=PlayerPedId()local eQ=ez(type)local eR=ey(type)local bB=GetFrom(ap)if IsEntityPlayingAnim(eH,"anim@heists@ornate_bank@grab_cash","cart_cash_dissapear",3)then return end;while not NetworkHasControlOfEntity(eH)do Citizen.Wait(1)NetworkRequestControlOfEntity(eH)end;local eS=GetEntityCoords(ped)local eT=CreateObject("hei_p_m_bag_var22_arm_s",eS+vector3(0.0,0.0,-6.0),true)SetEntityCollision(eT,false,true)local eU=eF(eT,eH)developer("^3Scenes^0","Started Intro scene")SetPedComponentVariation(ped,5,0,0,0)Citizen.Wait(1500)developer("^3Scenes^0","Create cash prop")eB(ap,eQ,bB.giveCash)developer("^3Scenes^0","Starting grabbing scene")local eJ=eO(eT,eH)developer("^3Scenes^0","Started grab scene")eI(eJ,bB.minSpeed or 1.0,bB.maxSpeed or 1.6,bB.repeatedlyPress)eA(ap,bB.giveCash)SetEntityModel(eH,eR)w.Cache.LootingTrolly=false;local eV=eP(eT,eH)developer("^3Scenes^0","Started exit scene",eH)Citizen.Wait(1800)DeleteEntity(eT)StopScene(eU)StopScene(eJ)StopScene(eV)developer("^3Scenes^0","Stopped all scenes",eH)SetPedComponentVariation(ped,5,45,0,0)end;local eW=false;local eX=false;Citizen.CreateThread(function()AddRelationshipGroup("GUARDS")SetPedRelationshipGroupHash(PlayerPedId(),GetHashKey("PLAYER"))end)local eY=function(bi,aI)if HasEntityClearLosToEntity(aI,bi,27)and GetPedTaskCombatTarget(aI)~=bi then TaskCombatHatedTargetsAroundPed(aI,10.0,0)SetRelationshipBetweenGroups(5,GetHashKey("GUARDS"),GetHashKey("PLAYER"))SetPedToInformRespectedFriends(aI,30.0,3)SetPedAiBlipHasCone(aI,false)if not eX then eX=true;TriggerEvent("Utility:On:spotted",aI)end end end;local eZ=function()if not eW then eW=true;Citizen.CreateThread(function()while eW do if next(w.Cache.Guards)then local bi=PlayerPedId()local U=GetEntityCoords(bi)local e_=GetPedStealthMovement(bi)local aA=e_ and 30.0 or 60.0;local f0=IsPedRunning(bi)for ba,aI in ipairs(w.Cache.Guards)do local f1=GetEntityCoords(aI)if IsPedDeadOrDying(aI)then SetPedCanRagdoll(aI,true)SetEntityAsNoLongerNeeded(aI)table.remove(w.Cache.Guards,ba)else if#(U-f1)<(f0 and 8.0 or 5.0)then eY(bi,aI)end;if#(U-f1)<aA then local f2=GetOffsetFromEntityInWorldCoords(aI,0.0,aA,0.0)if IsEntityInAngledArea(PlayerPedId(),f1,f2,50.0)then eY(bi,aI)end end;if IsPedShooting(aI)or IsPedInCombat(aI)then SetPedToInformRespectedFriends(aI,30.0,3)SetPedAiBlipHasCone(aI,false)if not eX then eX=true;TriggerEvent("Utility:On:spotted",aI)end end end end else eX=false;eW=false end;Citizen.Wait(500)end end)end end;SetGuardDifficulty=function(f3,f4)local f5,f6,f7,f8,f9=0,0,0,0,0;if f4=="easy"then f6=1;f7=40;f8=0;f9=0 elseif f4=="medium"then f6=2;f7=60;f8=2;f9=1 elseif f4=="hard"then f6=3;f7=80;f8=2;f9=2;f5=50 elseif f4=="veryhard"then f6=3;f7=95;f8=2;f9=2;f5=100 end;SetPedArmour(ped,f5)SetPedAlertness(ped,f6)SetPedAccuracy(ped,f7)SetPedCombatRange(ped,f8)SetPedCombatAbility(ped,f9)end;CreateGuard=function(af,U,_,f4,fa)local ped,ai=CreatePed(af,U,_,true)SetPedAiBlip(ped,true)SetPedAiBlipForcedOn(ped,true)SetPedAiBlipHasCone(ped,true)SetPedRandomComponentVariation(ped,0)SetPedRandomProps(ped)SetPedCanRagdoll(ped,false)SetPedCombatMovement(ped,2)SetGuardDifficulty(ped,f4)SetPedCombatAttributes(ped,46,true)SetPedFleeAttributes(ped,0,false)SetPedRelationshipGroupHash(ped,GetHashKey("GUARDS"))if fa then TaskPatrol(ped,"miss_"..fa,1,0,1)end;table.insert(w.Cache.Guards,ped)eZ()return ped end;CreateGuardRoute=function(bK,fb,fc)OpenPatrolRoute("miss_"..bK)local fd={}for az=1,#fb do local fe=fb[az]if type(fe)=="vector3"then AddPatrolRouteNode(az,"StandGuard",fe,fe,5000)else AddPatrolRouteNode(az,fe.anim or"StandGuard",fe.destination,fe.viewat or fe.destination,fe.wait or 5000)end;if fc then fc(az-1,az)else if az==#fb then AddPatrolRouteLink(az,1)table.insert(fd,{fb[az],fb[1]})end;if az>1 then AddPatrolRouteLink(az-1,az)table.insert(fd,{fb[az-1],fb[az]})end end end;ClosePatrolRoute()CreatePatrolRoute()if DevModeStatus then Citizen.CreateThread(function()while true do for az=1,#fd do DrawLine(fd[az][1],fd[az][2],255,0,0,255)end;Citizen.Wait(0)end end)end end;SetGuardRoute=function(f3,ff)TaskPatrol(f3,"miss_"..ff,1,0,1)end;SetEntityModel=function(aj,af)TriggerServerEvent("Utility:SwapModel",GetEntityCoords(aj),GetEntityModel(aj),type(af)=="string"and GetHashKey(af)or af)end;StopCurrentTaskAndWatchPlayer=function(ped,ae)local Y=GetEntityCoords(ped,true)local Z=GetEntityCoords(PlayerPedId(),true)local _=GetHeadingFromVector_2d(Z.x-Y.x,Z.y-Y.y)TaskAchieveHeading(ped,_,ae or 2000)end;StartParticleFxOnNetworkEntity=function(fg,bK,ah,...)TriggerServerEvent("Utility:StartParticleFxOnNetworkEntity",fg,bK,ObjToNet(ah),...)end;GetEntitySize=function(aj)local af=GetEntityModel(aj)local eK,eL=GetModelDimensions(af)return eL-eK end;DebugCoords=function(U)Citizen.CreateThread(function()while true do DrawText3Ds(U,"V")Citizen.Wait(0)end end)end;GetDirectionFromVectors=function(fh,fi)return fh-fi end;RotationToDirection=function(bP)local fj={x=math.pi/180*bP.x,y=math.pi/180*bP.y,z=math.pi/180*bP.z}local bF={x=-math.sin(fj.z)*math.abs(math.cos(fj.x)),y=math.cos(fj.z)*math.abs(math.cos(fj.x)),z=math.sin(fj.x)}return vector3(bF.x,bF.y,bF.z)end;SetVehicleWheelsPowered=function(al,ak)for az=0,GetVehicleNumberOfWheels(al)-1 do SetVehicleWheelIsPowered(al,az,ak)end end;apairs=function(cc,fk)local fl={}local az=0;for ba in pairs(cc)do table.insert(fl,ba)end;table.sort(fl,fk)local fm=function()az=az+1;if fl[az]==nil then return nil else return fl[az],cc[fl[az]]end end;return fm end;math.lerp=function(dV,fn,fo)return dV+(fn-dV)*fo end;math.invlerp=function(dV,fn,b9)return(b9-dV)/(fn-dV)end;CreateMissionText=function(Q,ae)SetTextEntry_2("STRING")AddTextComponentString(Q)DrawSubtitleTimed(ae and math.floor(ae)or 60000*240,1)return{delete=function()ClearPrints()end}end;WaitNear=function(U)local bi=PlayerPedId()while#(GetEntityCoords(bi)-U)>10 do Citizen.Wait(100)end end;FindInTable=function(table,a0)for az=1,#table do if table[az]==a0 then return az end end;return nil end;GetRandom=function(table)local fp=math.random(1,#table)return table[fp]end;Probability=function(cv)return math.random(1,100)<=cv end;AddPercentage=function(cv,fq)return cv+cv*fq/100 end;RemovePercentage=function(cv,fq)return cv-cv*fq/100 end;InTimeRange=function(eK,eL)local bX=nil;if utc then local a8,a8,a8,fr=GetUtcTime()bX=fr else bX=GetClockHours()end;if eL>eK then if bX>=eK and bX<=eL then return true end else if bX<=eL or bX>=eK then return false end end end;quat2euler=function(fs)local ft=2*(fs.w*fs.x+fs.y*fs.z)local fu=1-2*(fs.x*fs.x+fs.y*fs.y)local fv=math.atan2(ft,fu)local fw=math.sqrt(1+2*(fs.w*fs.y-fs.x*fs.z))local fx=math.sqrt(1-2*(fs.w*fs.y-fs.x*fs.z))local fy=2*math.atan2(fw,fx)-math.pi/2;local fz=2*(fs.w*fs.z+fs.x*fs.y)local fA=1-2*(fs.y*fs.y+fs.z*fs.z)local fB=math.atan2(fz,fA)return vec3(math.deg(fv),math.deg(fy),math.deg(fB))end;GenerateMatrix=function(bh,bG)local fC,fD,fE=math.rad(bG.x),math.rad(bG.y),math.rad(bG.z)local fF,fG=math.cos(fC),math.sin(fC)local fH,fI=math.cos(fD),math.sin(fD)local fJ,fK=math.cos(fE),math.sin(fE)local fL=mat3(vec3(1,0,0),vec3(0,fF,-fG),vec3(0,fG,fF))local fM=mat3(vec3(fH,0,fI),vec3(0,1,0),vec3(-fI,0,fH))local fN=mat3(vec3(fJ,-fK,0),vec3(fK,fJ,0),vec3(0,0,1))local fO=fL*fM*fN;local fP=mat4(vec4(fO[1].x,fO[2].x,fO[3].x,0),vec4(fO[1].y,fO[2].y,fO[3].y,0),vec4(fO[1].z,fO[2].z,fO[3].z,0),vec4(bh.x,bh.y,bh.z,1))return fP end;GetOffsetFromPositionInWorldCoords=function(bh,bG,cZ)local fQ=GenerateMatrix(bh,bG)return fQ*cZ end;GetInteriorPositionAndRotation=function(fR)local bh=vec3(GetInteriorPosition(fR))local bG=vec4(GetInteriorRotation(fR))bG=quat2euler(bG)return bh,bG end;GetOffsetFromInteriorInWorldCoords=function(fR,cZ)local bh,bG=GetInteriorPositionAndRotation(fR)return GetOffsetFromPositionInWorldCoords(bh,bG,cZ)end;local fS={}local fT=GetEntityArchetypeName;GetEntityArchetypeName=function(aj)if not aj or not DoesEntityExist(aj)then return""end;local fU=fT(aj)if fU==""then return Entity(aj).state.abstract_model or fU else return fU end end;UtilityNet.ForEachEntity=function(fV,fW)local fX=UtilityNet.GetEntities(fW)local n=0;if fX then local fY,fZ=next(fX)while fY do local ba,aI=next(fZ)while ba do n=n+1;local f_=fV(aI,ba)if f_~=nil then return f_ end;ba,aI=next(fX[fY],ba)end;fY,fZ=next(fX,fY)end end end;UtilityNet.SetDebug=function(bT)UtilityNetDebug=bT;local g0={}Citizen.CreateThread(function()while UtilityNetDebug do local U=GetEntityCoords(PlayerPedId())local bg=GetSliceFromCoords(U)local fW=GetSurroundingSlices(bg)g0={}UtilityNet.ForEachEntity(function(aI)if aI.createdBy==GetCurrentResourceName()then local ah=UtilityNet.GetEntityFromUNetId(aI.id)if DoesEntityExist(ah)then table.insert(g0,{obj=ah,netId=aI.id})end end end)Citizen.Wait(3000)end end)Citizen.CreateThread(function()while UtilityNetDebug do for ba,aI in pairs(g0)do local bT=UtilityNet.State(aI.netId)if DoesEntityExist(aI.obj)then DrawText3Ds(GetEntityCoords(aI.obj),"NetId: "..aI.netId,0.25)end end;Citizen.Wait(1)end end)end;UtilityNet.SetModelRenderDistance=function(af,aA)TriggerServerEvent("Utility:Net:SetModelRenderDistance",af,aA)end;UtilityNet.CreateEntity=function(af,U,bB)if type(af)~="string"then error("Invalid model, got "..type(af).." expected string",0)end;bB=bB or{}bB.createdBy=GetCurrentResourceName()local g1=math.random(0,10000000)local A=nil;local aj=promise:new()A=RegisterNetEvent("Utility:Net:EntityCreated",function(g2,g3)if g2==g1 then aj:resolve(g3.id)RemoveEventHandler(A)end end)TriggerLatentServerEvent("Utility:Net:CreateEntity",5120,g1,af,U,bB)local ap=Citizen.Await(aj)table.insert(fS,ap)return ap end;UtilityNet.DoesEntityExist=function(g4)return DoesEntityExist(UtilityNet.GetEntityFromUNetId(g4))end;UtilityNet.GetClosestRenderedNetIdOfType=function(U,av,af)local g5=exports["utility_lib"]:GetRenderedEntities()local aw=nil;local g6=math.huge;for ba,aI in pairs(g5)do if DoesEntityExist(aI.obj)and GetEntityModel(aI.obj)==af then local dE=#(U-GetEntityCoords(aI.obj))if dE<g6 then aw=ba;g6=dE end end end;return aw end;UtilityNet.GetClosestRenderedObjectOfType=function(U,av,af)local aw=UtilityNet.GetClosestRenderedNetIdOfType(U,av,af)if aw then return UtilityNet.GetEntityFromUNetId(aw)end end;UtilityNet.GetClosestNetIdOfType=function(U,av,af)if type(af)=="string"then af=GetHashKey(af)end;local aw=nil;local g6=math.huge;local bg=GetSliceFromCoords(U)local fW=GetSurroundingSlices(bg)UtilityNet.ForEachEntity(function(aj)if aj.model==af then local aA=#(U-aj.coords)if aA<av and aA<g6 then g6=aA;aw=aj.id end end end,{bg,table.unpack(fW)})return aw end;UtilityNet.DeleteEntity=function(g4)TriggerServerEvent("Utility:Net:DeleteEntity",g4)for ba,aI in pairs(fS)do if aI==g4 then table.remove(fS,ba)break end end end;UtilityNet.AttachToEntity=function(g4,g3,g7,bh,bG,g8,g9,dS,ga)local gb={bone=g7,pos=bh,rot=bG,useSoftPinning=g8,collision=g9,rotationOrder=dS,syncRot=ga}gb.isUtilityNet=true;TriggerServerEvent("Utility:Net:AttachTo",g4,g3,gb)end;UtilityNet.AttachToNetId=function(g4,ai,g7,bh,bG,g8,g9,dS,ga)local gb={bone=g7,pos=bh,rot=bG,useSoftPinning=g8,collision=g9,rotationOrder=dS,syncRot=ga}if not NetworkDoesNetworkIdExist(ai)then error("Invalid network id",2)return end;TriggerServerEvent("Utility:Net:AttachTo",g4,ai,gb)end;UtilityNet.DetachEntity=function(g4)local ah=UtilityNet.GetEntityFromUNetId(g4)if not IsEntityAttached(ah)then error("Entity "..g4 .." ("..ah..") is not attached to anything",2)return end;TriggerServerEvent("Utility:Net:DetachEntity",g4)while IsEntityAttached(ah)do Citizen.Wait(1)end;local bT=UtilityNet.State(g4)while bT.__attached do Citizen.Wait(1)end end;UtilityNet.SetEntityCoords=function(g4,U,gc)TriggerLatentServerEvent("Utility:Net:SetEntityCoords",5120,g4,U)TriggerEvent("Utility:Net:RefreshCoords",g4,U,gc)end;UtilityNet.SetEntityRotation=function(g4,bG,gd)TriggerLatentServerEvent("Utility:Net:SetEntityRotation",5120,g4,bG,gd)TriggerEvent("Utility:Net:RefreshRotation",g4,bG,gd)end;UtilityNet.SetEntityModel=function(g4,af)TriggerLatentServerEvent("Utility:Net:SetEntityModel",5120,g4,af)TriggerEvent("Utility:Net:RefreshModel",g4,af)end;UtilityNet.GetEntityCoords=function(g4)local aj=UtilityNet.InternalFindFromNetId(g4)if aj then return aj.coords end end;UtilityNet.GetEntityRotation=function(g4)local aj=UtilityNet.InternalFindFromNetId(g4)if aj then return aj.options.rotation end end;UtilityNet.PreserveEntity=function(g4)local aj=UtilityNet.GetEntityFromUNetId(g4)if aj then Entity(aj).state.preserved=true else warn("PreserverEntity: Entity with uNetId "..g4 .." not found")end end;UtilityNet.OnRender=function(ge)AddEventHandler("Utility:Net:OnRender",ge)end;UtilityNet.OnUnrender=function(ge)AddEventHandler("Utility:Net:OnUnrender",ge)end;UtilityNet.IsReady=function(g4)local ah=UtilityNet.GetEntityFromUNetId(g4)return DoesEntityExist(ah)and UtilityNet.IsEntityRendered(ah)end;UtilityNet.IsEntityRendered=function(ah)local bT=Entity(ah).state;return bT.rendered end;UtilityNet.DoesUNetIdExist=function(g4)local aj=UtilityNet.InternalFindFromNetId(g4)return aj~=nil end;local gf={}local gg=nil;UtilityNet.AddStateBagChangeHandler=function(g4,gh)if not gf[g4]then gf[g4]={}end;table.insert(gf[g4],gh)if not gg then gg=RegisterNetEvent("Utility:Net:UpdateStateValue",function(gi,K,b9)local gj=gf[gi]if not gj then return end;for a8,gk in pairs(gj)do gk(K,b9)end end)end;return gh end;UtilityNet.RemoveStateBagChangeHandler=function(gk)for g4,gj in pairs(gf)do for az,gl in pairs(gj)do if gl==gk then table.remove(gj,az)return end end end;if not next(gf)then RemoveEventHandler(gg)gg=nil end end;UtilityNet.State=function(g4)local bT=setmetatable({},{__index=function(a8,ba)return exports["utility_lib"]:GetEntityStateValue(g4,ba)end,__newindex=function(a8,ba,aI)error("Cannot set states from client")end})return bT end;UtilityNet.StateFromObj=function(ah)local ai=UtilityNet.GetUNetIdFromEntity(ah)return UtilityNet.State(ai)end;UtilityNet.GetEntityFromUNetId=function(g4)return exports["utility_lib"]:GetEntityFromUNetId(g4)end;UtilityNet.GetUNetIdFromEntity=function(aj)return exports["utility_lib"]:GetUNetIdFromEntity(aj)end;UtilityNet.GetuNetIdCreator=function(g4)return exports["utility_lib"]:GetuNetIdCreator(g4)end;UtilityNet.GetEntityCreator=function(aj)return exports["utility_lib"]:GetEntityCreator(aj)end;UtilityNet.InternalFindFromNetId=function(g4)return exports["utility_lib"]:InternalFindFromNetId(g4)end;UtilityNet.GetEntities=function(fW)return exports["utility_lib"]:GetEntities(fW)end;UtilityNet.GetServerEntities=function(gm)return exports["utility_lib"]:GetServerEntities(gm)end;AddEventHandler("onResourceStop",function(gn)local go=GetCurrentResourceName()if gn==go then for ba,aI in pairs(fS)do TriggerServerEvent("Utility:Net:DeleteEntity",aI)end end end)